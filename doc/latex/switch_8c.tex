\hypertarget{switch_8c}{}\section{switch.\+c File Reference}
\label{switch_8c}\index{switch.\+c@{switch.\+c}}


Determine if a switch is necessary and validate that there is no exclusion.  


{\ttfamily \#include \char`\"{}include/switch.\+h\char`\"{}}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{switch_8c_a1098e966ee9937714052acc60069827b}{active\+Task} ()
\begin{DoxyCompactList}\small\item\em send a command to taskwarrior to check for active tasks \end{DoxyCompactList}\item 
\mbox{\Hypertarget{switch_8c_af19264fb0f56dc09d1d4ee5c5aec0ee8}\label{switch_8c_af19264fb0f56dc09d1d4ee5c5aec0ee8}} 
int {\bfseries pclose} (F\+I\+LE $\ast$stream)
\item 
\mbox{\Hypertarget{switch_8c_a8d6c866e31aca8f7ed24b5f2e5dea89c}\label{switch_8c_a8d6c866e31aca8f7ed24b5f2e5dea89c}} 
F\+I\+LE $\ast$ {\bfseries popen} (const char $\ast$command, const char $\ast$type)
\item 
int \hyperlink{switch_8c_a5d692389b7566bc79b91268f1f5f40aa}{range\+Match} (struct format\+\_\+type $\ast$range, struct tm $\ast$date)
\begin{DoxyCompactList}\small\item\em compare if a date is inside a range of 2 dates start-\/$>$end \end{DoxyCompactList}\item 
int \hyperlink{switch_8c_a09288ca33b1042212dd75ae6de4bb1ff}{send\+Command} (char $\ast$input)
\begin{DoxyCompactList}\small\item\em send a command to taskwarrior to switch to the specified context \end{DoxyCompactList}\item 
int \hyperlink{switch_8c_a6efbe837e5109b9dc9b8520dbd517b41}{stop\+Task} ()
\begin{DoxyCompactList}\small\item\em send a command to taskwarrior, stop any Active task \end{DoxyCompactList}\item 
S\+W\+I\+T\+C\+H\+\_\+\+S\+T\+A\+TE \hyperlink{switch_8c_abc3d6ca5c0a4cfbe8d0e71453d61ca5a}{switch\+Context} (struct config $\ast$conf, int time, char $\ast$new\+\_\+context, char $\ast$current\+\_\+context)
\begin{DoxyCompactList}\small\item\em compare the current date, with the zone settings in the config \end{DoxyCompactList}\item 
E\+X\+C\+L\+U\+S\+I\+O\+N\+\_\+\+S\+T\+A\+TE \hyperlink{switch_8c_ad8b00234bfa76e26008f136aca366c0b}{switch\+Exclusion} (struct exclusion $\ast$excl, struct tm $\ast$date)
\begin{DoxyCompactList}\small\item\em Determine if the current date is excluded from switching the context. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Determine if a switch is necessary and validate that there is no exclusion. 

\begin{DoxyAuthor}{Author}
Sebastian Fricke 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2019-\/12-\/01 Compare exclusions with the active setting. Compare the zones with current time. Send commands to task warrior to stop tasks, find active tasks or switch a context 
\end{DoxyDate}


\subsection{Function Documentation}
\mbox{\Hypertarget{switch_8c_a1098e966ee9937714052acc60069827b}\label{switch_8c_a1098e966ee9937714052acc60069827b}} 
\index{switch.\+c@{switch.\+c}!active\+Task@{active\+Task}}
\index{active\+Task@{active\+Task}!switch.\+c@{switch.\+c}}
\subsubsection{\texorpdfstring{active\+Task()}{activeTask()}}
{\footnotesize\ttfamily int active\+Task (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



send a command to taskwarrior to check for active tasks 

uses \textquotesingle{}2$<$\&1\textquotesingle{} to redirect the stderr output to stdout


\begin{DoxyRetVals}{Return values}
{\em 0} & No active Task \\
\hline
{\em 1} & Active Task \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{switch_8c_a5d692389b7566bc79b91268f1f5f40aa}\label{switch_8c_a5d692389b7566bc79b91268f1f5f40aa}} 
\index{switch.\+c@{switch.\+c}!range\+Match@{range\+Match}}
\index{range\+Match@{range\+Match}!switch.\+c@{switch.\+c}}
\subsubsection{\texorpdfstring{range\+Match()}{rangeMatch()}}
{\footnotesize\ttfamily int range\+Match (\begin{DoxyParamCaption}\item[{struct format\+\_\+type $\ast$}]{range,  }\item[{struct tm $\ast$}]{date }\end{DoxyParamCaption})}



compare if a date is inside a range of 2 dates start-\/$>$end 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em range} & sub structure of the exclusion struct contain start, end \\
\hline
\mbox{\tt in}  & {\em date} & tm structure of the current date\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 1} & S\+U\+C\+C\+E\+SS date in inbetween start and end \\
\hline
{\em 0} & date is N\+OT inbetween start and end \\
\hline
{\em -\/1} & F\+A\+I\+L\+U\+RE struct from exclusion struct not found \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{switch_8c_a09288ca33b1042212dd75ae6de4bb1ff}\label{switch_8c_a09288ca33b1042212dd75ae6de4bb1ff}} 
\index{switch.\+c@{switch.\+c}!send\+Command@{send\+Command}}
\index{send\+Command@{send\+Command}!switch.\+c@{switch.\+c}}
\subsubsection{\texorpdfstring{send\+Command()}{sendCommand()}}
{\footnotesize\ttfamily int send\+Command (\begin{DoxyParamCaption}\item[{char $\ast$}]{input }\end{DoxyParamCaption})}



send a command to taskwarrior to switch to the specified context 

watch the reaction from taskwarrior for success

param\mbox{[}in\mbox{]} input specified context


\begin{DoxyRetVals}{Return values}
{\em 0} & S\+U\+C\+C\+E\+SS \\
\hline
{\em -\/1} & F\+A\+I\+L\+U\+RE \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{switch_8c_a6efbe837e5109b9dc9b8520dbd517b41}\label{switch_8c_a6efbe837e5109b9dc9b8520dbd517b41}} 
\index{switch.\+c@{switch.\+c}!stop\+Task@{stop\+Task}}
\index{stop\+Task@{stop\+Task}!switch.\+c@{switch.\+c}}
\subsubsection{\texorpdfstring{stop\+Task()}{stopTask()}}
{\footnotesize\ttfamily int stop\+Task (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



send a command to taskwarrior, stop any Active task 

uses \textquotesingle{}2$<$\&1\textquotesingle{} to redirect the stderr output to stdout


\begin{DoxyRetVals}{Return values}
{\em 0} & S\+U\+C\+C\+E\+SS \\
\hline
{\em -\/1} & F\+A\+I\+L\+U\+RE \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{switch_8c_abc3d6ca5c0a4cfbe8d0e71453d61ca5a}\label{switch_8c_abc3d6ca5c0a4cfbe8d0e71453d61ca5a}} 
\index{switch.\+c@{switch.\+c}!switch\+Context@{switch\+Context}}
\index{switch\+Context@{switch\+Context}!switch.\+c@{switch.\+c}}
\subsubsection{\texorpdfstring{switch\+Context()}{switchContext()}}
{\footnotesize\ttfamily S\+W\+I\+T\+C\+H\+\_\+\+S\+T\+A\+TE switch\+Context (\begin{DoxyParamCaption}\item[{struct config $\ast$}]{conf,  }\item[{int}]{time,  }\item[{char $\ast$}]{new\+\_\+context,  }\item[{char $\ast$}]{current\+\_\+context }\end{DoxyParamCaption})}



compare the current date, with the zone settings in the config 

On a match return the context from the zone and a signal for further execution


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em conf} & config structure instance pointer \\
\hline
\mbox{\tt in}  & {\em time} & current time in minutes \\
\hline
\mbox{\tt in}  & {\em current\+\_\+context} & active context in taskwarrior \\
\hline
\mbox{\tt out}  & {\em new\+\_\+context} & context found in the active zone\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em S\+W\+I\+T\+C\+H\+\_\+\+S\+U\+C\+C\+E\+SS} & current \& new context differ \\
\hline
{\em S\+W\+I\+T\+C\+H\+\_\+\+N\+O\+T\+N\+E\+E\+D\+ED} & current \& new context are equal \\
\hline
{\em S\+W\+I\+T\+C\+H\+\_\+\+F\+A\+I\+L\+U\+RE} & time is not within any zone \\
\hline
\end{DoxyRetVals}
\mbox{\Hypertarget{switch_8c_ad8b00234bfa76e26008f136aca366c0b}\label{switch_8c_ad8b00234bfa76e26008f136aca366c0b}} 
\index{switch.\+c@{switch.\+c}!switch\+Exclusion@{switch\+Exclusion}}
\index{switch\+Exclusion@{switch\+Exclusion}!switch.\+c@{switch.\+c}}
\subsubsection{\texorpdfstring{switch\+Exclusion()}{switchExclusion()}}
{\footnotesize\ttfamily E\+X\+C\+L\+U\+S\+I\+O\+N\+\_\+\+S\+T\+A\+TE switch\+Exclusion (\begin{DoxyParamCaption}\item[{struct exclusion $\ast$}]{excl,  }\item[{struct tm $\ast$}]{date }\end{DoxyParamCaption})}



Determine if the current date is excluded from switching the context. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em date} & tm structure pointer to the current date \& time \\
\hline
\mbox{\tt in}  & {\em excl} & exclusion structure instance pointer\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em E\+X\+L\+C\+U\+S\+I\+O\+N\+\_\+\+M\+A\+T\+CH} & \\
\hline
{\em E\+X\+C\+L\+U\+S\+I\+O\+N\+\_\+\+N\+O\+M\+A\+T\+CH} & \\
\hline
{\em E\+X\+L\+C\+U\+S\+I\+O\+N\+\_\+\+E\+R\+R\+OR} & \\
\hline
\end{DoxyRetVals}
